# APDL_整体架构设计

## 1. 架构概述

APDL（Adaptive Protocol Definition Language）是一个自适应协议定义语言框架，旨在提供灵活、可扩展的协议定义和处理能力。该框架采用模块化设计，各模块职责清晰，相互协作完成协议处理任务。

## 2. 核心模块

### 2.1 POEM - 协议编排与扩展模块

POEM模块是APDL框架的核心处理单元，负责协议的编排、扩展和管理。

#### 2.1.1 字节序管理机制

最新版本引入了统一的字节序管理机制：

- **内部统一存储**：所有数据在内部统一使用大端字节序（Big Endian）进行存储和处理，确保内部逻辑的一致性
- **外部字节序适配**：支持字段级别的字节序配置，可在输出到字段或从字段读取时自动进行字节序转换
- **透明转换**：在设置和获取字段值时自动进行字节序转换，对用户透明

#### 2.1.2 主要组件

- **FrameAssembler**：协议帧组装器，负责协议帧的组装和解析
- **Rule Handlers**：规则处理器，处理各种协议规则（如序列控制、校验等）
- **Connectors**：连接器，负责字段映射和数据放置

## 3. 设计原则

### 3.1 字节序处理原则

- **统一性**：内部统一使用大端字节序，简化内部处理逻辑
- **透明性**：对外提供透明的字节序转换，用户无需关心内部实现
- **兼容性**：保持与现有功能的向后兼容
- **可扩展性**：支持未来添加更多字节序类型

## 4. 模块交互

### 4.1 字节序处理流程

1. **字段值设置**：外部数据 → 字节序转换 → 内部大端存储
2. **字段值获取**：内部大端存储 → 字节序转换 → 外部数据
3. **序列控制**：在内部大端字节序上直接进行数值运算

## 5. 扩展性考虑

框架设计考虑了未来的扩展需求，包括：
- 支持更多的字节序类型
- 字段级别的精细化配置
- 向后兼容的接口设计